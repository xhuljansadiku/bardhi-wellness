<!doctype html>
<html lang="sq" data-bs-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CoachPro – Admin Dashboard</title>
  <meta name="description" content="Panel administrimi: statistika, përdorues, abonime dhe porosi." />

  <!-- Bootstrap & Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <style>
    :root{ --brand:#7C4DFF; --soft:#f6f7fb }
    body{font-family:system-ui,-apple-system,Segoe UI,Inter,Roboto,Helvetica,Arial,sans-serif}
    .sidebar{width:280px}
    .sidebar .nav-link{color:#6b7280}
    .sidebar .nav-link.active{background:rgba(124,77,255,.1);color:#3d2ea7;border-radius:.75rem}
    .sidebar .nav-link i{width:1.4rem}
    .brand-mark{width:36px;height:36px;border-radius:10px;background:linear-gradient(180deg,#b89cff,#7C4DFF);display:inline-grid;place-items:center;color:#fff}
    .content{min-height:100vh;background:var(--soft)}
    .rounded-2xl{border-radius:1.25rem}
    .shadow-soft{box-shadow:0 18px 50px rgba(15,18,33,.08)}
    .table thead th{white-space:nowrap}
    .kpi{display:flex;align-items:center;gap:.75rem}
    .kpi i{font-size:1.6rem}
    .status-pill{border-radius:999px;padding:.25rem .6rem}
    @media (max-width: 991.98px){ .sidebar{position:fixed; z-index:1045; top:0; bottom:0; left:0; transform:translateX(-100%); transition:transform .2s ease; background:#fff} .sidebar.show{transform:translateX(0)} }
  </style>
</head>
<body>
  <header class="border-bottom bg-white sticky-top">
    <div class="container-fluid px-3 py-2 d-flex align-items-center justify-content-between">
      <div class="d-flex align-items-center gap-2">
        <button class="btn btn-light d-lg-none" id="btnSidebar" aria-label="Menu"><i class="bi bi-list"></i></button>
        <span class="brand-mark"><i class="bi bi-activity"></i></span>
        <span class="fw-bold">CoachPro Admin</span>
      </div>
      <form class="d-none d-md-flex align-items-center" role="search" style="max-width:420px; width:100%">
        <div class="input-group">
          <span class="input-group-text bg-white"><i class="bi bi-search"></i></span>
          <input class="form-control" type="search" placeholder="Kërko përdorues, porosi, abonime..." />
        </div>
      </form>
      <div class="d-flex align-items-center gap-2">
        <button class="btn btn-light" id="btnTheme" aria-label="Ndrysho temën"><i class="bi bi-moon"></i></button>
        <button class="btn btn-light" data-bs-toggle="offcanvas" data-bs-target="#filters"><i class="bi bi-sliders"></i></button>
        <div class="dropdown">
          <button class="btn btn-outline-secondary dropdown-toggle" data-bs-toggle="dropdown"><i class="bi bi-person-circle me-1"></i>Admin</button>
          <ul class="dropdown-menu dropdown-menu-end">
            <li><a class="dropdown-item" href="#">Profili</a></li>
            <li><a class="dropdown-item" href="#">Cilësimet</a></li>
            <li><hr class="dropdown-divider"></li>
            <button class="btn btn-outline-secondary" id="btnAdminLogout">
  <i class="bi bi-box-arrow-right me-1"></i>Logout
</button>
          </ul>
        </div>
      </div>
    </div>
  </header>

  <div class="d-flex">
    <!-- SIDEBAR -->
    <nav class="sidebar border-end p-3 d-flex flex-column gap-2 bg-white" id="sidebar">
      <div class="text-uppercase small text-muted px-2">Navigim</div>
      <a class="nav-link active px-3 py-2" href="#"><i class="bi bi-speedometer2"></i> Dashboard</a>
      <a class="nav-link px-3 py-2" href="#users"><i class="bi bi-people"></i> Users</a>
      <a class="nav-link px-3 py-2" href="#plans"><i class="bi bi-box-seam"></i> Plans</a>
      <a class="nav-link px-3 py-2" href="#orders"><i class="bi bi-receipt"></i> Orders</a>
      <a class="nav-link px-3 py-2" href="#content"><i class="bi bi-collection-play"></i> Content</a>
      <a class="nav-link px-3 py-2" href="#settings"><i class="bi bi-gear"></i> Settings</a>
      <div class="mt-auto small text-muted px-2">© <span id="year"></span> CoachPro</div>
    </nav>

    <!-- MAIN CONTENT -->
    <main class="content flex-grow-1 p-3 p-lg-4">
      <div class="container-fluid">
        <!-- KPIs -->
        <div class="row g-3 mb-3">
          <div class="col-12 col-md-6 col-xl-3">
            <div class="card rounded-2xl shadow-soft border-0">
              <div class="card-body">
                <div class="kpi"><i class="bi bi-person-plus"></i><div><div class="text-muted small">New Signups</div><div class="fs-4 fw-bold" id="kpiSignups">0</div></div></div>
              </div>
            </div>
          </div>
          <div class="col-12 col-md-6 col-xl-3">
            <div class="card rounded-2xl shadow-soft border-0">
              <div class="card-body">
                <div class="kpi"><i class="bi bi-credit-card"></i><div><div class="text-muted small">MRR</div><div class="fs-4 fw-bold">€<span id="kpiMRR">0</span></div></div></div>
              </div>
            </div>
          </div>
          <div class="col-12 col-md-6 col-xl-3">
            <div class="card rounded-2xl shadow-soft border-0">
              <div class="card-body">
                <div class="kpi"><i class="bi bi-arrow-repeat"></i><div><div class="text-muted small">Churn</div><div class="fs-4 fw-bold" id="kpiChurn">0%</div></div></div>
              </div>
            </div>
          </div>
          <div class="col-12 col-md-6 col-xl-3">
            <div class="card rounded-2xl shadow-soft border-0">
              <div class="card-body">
                <div class="kpi"><i class="bi bi-people-fill"></i><div><div class="text-muted small">Active Members</div><div class="fs-4 fw-bold" id="kpiActive">0</div></div></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Charts -->
        <div class="row g-3 mb-3">
          <div class="col-lg-8">
            <div class="card rounded-2xl shadow-soft border-0 h-100">
              <div class="card-header bg-white d-flex justify-content-between align-items-center"><span class="fw-semibold">Të ardhurat (6 muaj)</span><div class="btn-group btn-group-sm" role="group"><button class="btn btn-outline-secondary active" data-range="6m">6M</button><button class="btn btn-outline-secondary" data-range="12m">12M</button></div></div>
              <div class="card-body"><canvas id="chartRevenue" height="120"></canvas></div>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="card rounded-2xl shadow-soft border-0 h-100">
              <div class="card-header bg-white"><span class="fw-semibold">Regjistrime sipas planit</span></div>
              <div class="card-body"><canvas id="chartPlans" height="120"></canvas></div>
            </div>
          </div>
        </div>

        <!-- Tables -->
        <div class="row g-3">
          <div class="col-xl-7">
            <div class="card rounded-2xl shadow-soft border-0">
              <div class="card-header bg-white d-flex justify-content-between align-items-center">
                <span class="fw-semibold">Porositë e fundit</span>
                <div class="input-group input-group-sm" style="max-width:240px">
                  <span class="input-group-text bg-white"><i class="bi bi-search"></i></span>
                  <input class="form-control" id="ordersSearch" placeholder="Filtro sipas emrit..." />
                </div>
              </div>
              <div class="table-responsive">
                <table class="table align-middle mb-0" id="ordersTable">
                  <thead class="table-light">
                    <tr>
                      <th data-sort="string">Klienti</th>
                      <th class="text-nowrap" data-sort="string">Plani</th>
                      <th data-sort="number">Shuma</th>
                      <th data-sort="string">Status</th>
                      <th data-sort="string">Data</th>
                    </tr>
                  </thead>
                  <tbody>
                    <!-- rows injected by JS -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>
          <div class="col-xl-5">
            <div class="card rounded-2xl shadow-soft border-0 h-100">
              <div class="card-header bg-white"><span class="fw-semibold">Përdoruesit e rinj</span></div>
              <div class="list-group list-group-flush" id="newUsers">
                <!-- items injected by JS -->
              </div>
            </div>
          </div>
        </div>

      </div>
    </main>
  </div>

  <!-- Filters Offcanvas -->
  <div class="offcanvas offcanvas-end" tabindex="-1" id="filters">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title">Filtrat e dashboard-it</h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
    </div>
    <div class="offcanvas-body">
      <div class="mb-3">
        <label class="form-label">Data nga</label>
        <input type="date" class="form-control" id="fromDate" />
      </div>
      <div class="mb-3">
        <label class="form-label">Data deri</label>
        <input type="date" class="form-control" id="toDate" />
      </div>
      <div class="mb-3">
        <label class="form-label">Plani</label>
        <select class="form-select" id="planFilter">
          <option value="">Të gjithë</option>
          <option>Basic</option>
          <option>Pro</option>
          <option>Elite</option>
        </select>
      </div>
      <button class="btn btn-primary w-100" data-bs-dismiss="offcanvas">Apliko</button>
    </div>
  </div>

  <!-- Add User Modal -->
  <div class="modal fade" id="addUser" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header"><h5 class="modal-title">Shto përdorues</h5><button class="btn-close" data-bs-dismiss="modal"></button></div>
        <div class="modal-body">
          <form id="addUserForm" novalidate>
            <div class="mb-3"><label class="form-label">Emri</label><input class="form-control" id="uName" required></div>
            <div class="mb-3"><label class="form-label">Email</label><input type="email" class="form-control" id="uEmail" required></div>
            <div class="mb-3"><label class="form-label">Plani</label><select class="form-select" id="uPlan"><option>Basic</option><option>Pro</option><option>Elite</option></select></div>
            <button class="btn btn-primary w-100" type="submit">Ruaj</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <script>
  document.getElementById('btnAdminLogout')?.addEventListener('click', (e)=>{
    e.preventDefault();
    // pas backend-it: hiq tokenin e adminit
    localStorage.removeItem('adminToken');
    location.href = 'login.html';
  });
</script>


  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Year
    document.getElementById('year').textContent = new Date().getFullYear();

    // Mobile sidebar toggle
    const sidebar = document.getElementById('sidebar');
    document.getElementById('btnSidebar').addEventListener('click', ()=> sidebar.classList.toggle('show'));

    // Theme toggle (light/dark)
    const btnTheme = document.getElementById('btnTheme');
    btnTheme.addEventListener('click', ()=>{
      const html = document.documentElement; const current = html.getAttribute('data-bs-theme');
      html.setAttribute('data-bs-theme', current === 'dark' ? 'light' : 'dark');
    });

    // Fake data
    const orders = [
      {name:'Arbër G.', plan:'Pro', amount:39, status:'Paid', date:'2025-02-10'},
      {name:'Elira K.', plan:'Elite', amount:79, status:'Paid', date:'2025-02-10'},
      {name:'Bora M.', plan:'Basic', amount:19, status:'Refunded', date:'2025-02-09'},
      {name:'Dritan C.', plan:'Pro', amount:39, status:'Paid', date:'2025-02-08'},
      {name:'Rinor S.', plan:'Pro', amount:39, status:'Failed', date:'2025-02-08'}
    ];

    // Inject orders
    const tbody = document.querySelector('#ordersTable tbody');
    const statusClass = s => s==='Paid' ? 'bg-success-subtle text-success' : s==='Failed' ? 'bg-danger-subtle text-danger' : 'bg-warning-subtle text-warning';
    const renderOrders = (rows)=>{
      tbody.innerHTML = rows.map(r=>`<tr>
        <td>${r.name}</td>
        <td>${r.plan}</td>
        <td>€${r.amount}</td>
        <td><span class="status-pill ${statusClass(r.status)}">${r.status}</span></td>
        <td>${r.date}</td>
      </tr>`).join('');
    }
    renderOrders(orders);

    // Orders search
    document.getElementById('ordersSearch').addEventListener('input', (e)=>{
      const q = e.target.value.toLowerCase();
      renderOrders(orders.filter(o=>o.name.toLowerCase().includes(q)));
    });

    // New users list
    const newUsers = [
      {name:'Adelina', email:'adelina@example.com', created:'2h'},
      {name:'Klevis', email:'klevis@example.com', created:'5h'},
      {name:'Jora', email:'jora@example.com', created:'yesterday'}
    ];
    const list = document.getElementById('newUsers');
    list.innerHTML = newUsers.map(u=>`<div class="list-group-item d-flex justify-content-between align-items-center">
      <div><div class="fw-semibold">${u.name}</div><div class="small text-muted">${u.email}</div></div>
      <span class="badge bg-secondary-subtle text-secondary">${u.created}</span>
    </div>`).join('');

    // KPIs (demo animation)
    const animateNum = (el, target, suffix='')=>{ const start = performance.now(); const dur = 1000; const step = t=>{ const p=Math.min(1,(t-start)/dur); el.textContent = Math.round(target*p) + suffix; if(p<1) requestAnimationFrame(step)}; requestAnimationFrame(step)};
    animateNum(document.getElementById('kpiSignups'), 124);
    animateNum(document.getElementById('kpiMRR'), 8420);
    animateNum(document.getElementById('kpiChurn'), 4, '%');
    animateNum(document.getElementById('kpiActive'), 2317);

    // Charts
    const revCtx = document.getElementById('chartRevenue');
    const planCtx = document.getElementById('chartPlans');

    const months6 = ['Sep','Oct','Nov','Dec','Jan','Feb'];
    const revenue6 = [6200, 6800, 7400, 7900, 8200, 8600];

    let revenueChart = new Chart(revCtx, {
      type:'line', data:{ labels: months6, datasets:[{ label:'Revenue', data: revenue6, tension:.35, fill:true }] }, options:{ responsive:true, maintainAspectRatio:false, plugins:{ legend:{display:false} } }
    });

    new Chart(planCtx, { type:'doughnut', data:{ labels:['Basic','Pro','Elite'], datasets:[{ data:[35, 48, 17] }] }, options:{ plugins:{ legend:{ position:'bottom' } } }});

    // Range buttons
    document.querySelectorAll('[data-range]').forEach(btn=>btn.addEventListener('click', e=>{
      document.querySelectorAll('[data-range]').forEach(b=>b.classList.remove('active'));
      e.currentTarget.classList.add('active');
      if(btn.dataset.range==='12m'){
        revenueChart.data.labels = ['Mar','Apr','May','Jun','Jul','Aug',...months6];
        revenueChart.data.datasets[0].data = [5200,5400,5600,5900,6000,6100,...revenue6];
      } else {
        revenueChart.data.labels = months6; revenueChart.data.datasets[0].data = revenue6;
      }
      revenueChart.update();
    }));

    // Add user (demo)
    document.getElementById('addUserForm').addEventListener('submit', (e)=>{
      e.preventDefault();
      if(!e.target.checkValidity()){ e.target.classList.add('was-validated'); return; }
      const name = document.getElementById('uName').value; const email = document.getElementById('uEmail').value; const created='now';
      list.insertAdjacentHTML('afterbegin', `<div class=\"list-group-item d-flex justify-content-between align-items-center\">\n        <div><div class=\"fw-semibold\">${name}</div><div class=\"small text-muted\">${email}</div></div>\n        <span class=\"badge bg-secondary-subtle text-secondary\">${created}</span>\n      </div>`);
      e.target.reset(); e.target.classList.remove('was-validated');
      bootstrap.Modal.getInstance(document.getElementById('addUser')).hide();
    });
  </script>
</body>
</html>
